---
- name: Run "apt-get update"
  become: True
  apt:
    update_cache: True
    cache_valid_time: "3600"
  ignore_errors: True

- name: Install packages
  become: True
  apt:
    state: latest
    pkg:
      - stow
      - neovim
      - htop
      - conky-all
      - byobu
      - evolution-ews
      - guake
      - autokey-gtk
      - slack-desktop
      - powerline
      - curl
      - unzip
      - bat


- name: Check batcat is present before moving cat
  stat:
    path: "{{ batcat_path }}"
  register: bat_cat
  ignore_errors: True

- name: Copy cat to oldcat
  become: True
  copy:
    src: "{{ cat_path }}"
    dest: "{{ oldcat_path }}"
  when: bat_cat.stat.exists

- name: Remove cat
  become: True
  file:
    path: "{{ cat_path }}"
    state: absent
  when: bat_cat.stat.exists

- name: Set Batman to be a default cat be setting alternative of cat
  become: True
  alternatives:
    name: cat
    link: "{{ cat_path }}"
    path: "{{ batcat_path }}"
    priority: 20
  when: bat_cat.stat.exists

- name: Set {{ oldcat_path }} to be a backup cat
  become: True
  alternatives:
    name: cat
    link: "{{ cat_path }}"
    path: "{{ oldcat_path }}"
    priority: 10
  when: bat_cat.stat.exists
